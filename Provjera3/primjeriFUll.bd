1Ô∏è‚É£ Kreiraj indeks tako da nastavnik mo≈æe odr≈æati ispit iz nekog 
predmeta samo jednom u toku dana.

  CREATE UNIQUE INDEX ispit_unique
  ON ispit (sifNastavnik, sifPred, datIspit);


2Ô∏è‚É£ Studenti koji su stanovali u Dubrovniku preselili su se u Zagreb.
Po≈°tanske brojeve ne zna≈° napamet, ali ih dobija≈° iz tabele mjesto.

  UPDATE stud
  SET pbrStan = (
      SELECT pbr FROM mjesto WHERE nazMjesto = 'Zagreb'
  )
  WHERE pbrStan = (
      SELECT pbr FROM mjesto WHERE nazMjesto = 'Dubrovnik'
  );


3Ô∏è‚É£ Svi predmeti ƒçija se organizaciona jedinica zove 'AR' 
premje≈°teni su u organizacionu jedinicu 'RI'.

≈†ifre organizacionih jedinica nisu poznate direktno.

  UPDATE pred
  SET sifOrgjed = (
      SELECT sifOrgjed FROM orgjed
      WHERE nazOrgjed = 'RI'
  )
  WHERE sifOrgjed = (
      SELECT sifOrgjed FROM orgjed
      WHERE nazOrgjed = 'AR'
  );


4Ô∏è‚É£ Ispi≈°i ≈°ifre predmeta koji imaju prosjek pozitivnih ocjena 
veƒái od 3.

  SELECT sifPred
  FROM ispit
  WHERE ocjena > 1
  GROUP BY sifPred
  HAVING AVG(ocjena) > 3;


1Ô∏è‚É£ Provjeriti postojanje funkcijske zavisnosti
prezNastavnik, koef ‚Üí sifOrgjed u relaciji nastavnik.

  SELECT prezNastavnik, koef
  FROM nastavnik
  GROUP BY prezNastavnik, koef
  HAVING COUNT(DISTINCT sifOrgjed) > 1;


2Ô∏è‚É£ Kreirati privremenu relaciju orgjedTMP

koja ima sve atribute kao orgjed + atribute:

UpStud = ukupan broj upisanih studenata (suma upisanoStud) 
na svim predmetima te org. jedinice

PrUpStud = prosjeƒçan broj upisanih studenata na predmetima 
te org. jedinice.

  CREATE TEMPORARY TABLE orgjedTMP AS
  SELECT o.sifOrgjed,
         o.nazOrgjed,
         o.sifNadorgjed,
         SUM(p.upisanoStud) AS UpStud,
         AVG(p.upisanoStud) AS PrUpStud
  FROM orgjed o
  JOIN pred p ON p.sifOrgjed = o.sifOrgjed
  GROUP BY o.sifOrgjed, o.nazOrgjed, o.sifNadorgjed;


1Ô∏è‚É£ Postaviti indeks na 3 atributa u relaciji pred 
(npr. sifOrgjed, nazPred, brojSatiTjedno).

  CREATE INDEX pred_index
  ON pred (sifOrgjed, nazPred, brojSatiTjedno);


2Ô∏è‚É£ Napraviti TEMPORARY TABLE ispit1 istu kao ispit, 
i obrisati sve ispite prije 2000. godine.

  CREATE TEMPORARY TABLE ispit1 AS
  SELECT * FROM ispit;

  DELETE FROM ispit1
  WHERE datIspit < '2000-01-01';


3Ô∏è‚É£ Za svaku dvoranu ispisati: oznaku, kapacitet, 
broj razliƒçitih predmeta

koji se u njoj odr≈æavaju. Sortirati po broju predmeta 
opadajuƒáe, a za iste brojeve po oznaci dvorane uzlazno.

  SELECT d.oznDvorana,
         d.kapacitet,
         COUNT(DISTINCT r.sifPred) AS brPredmeta
  FROM dvorana d
  LEFT JOIN rezervacija r ON r.oznDvorana = d.oznDvorana
  GROUP BY d.oznDvorana, d.kapacitet
  ORDER BY brPredmeta DESC, d.oznDvorana ASC;


4Ô∏è‚É£ Ispisati mbrStud, prezime i broj nepolo≈æenih ispita (ocjena = 1).
Ispisati samo studente koji su pali na vi≈°e od 9 ispita.

  SELECT s.mbrStud,
         s.prezStud,
         COUNT(*) AS brojNepolozenih
  FROM stud s
  JOIN ispit i ON i.mbrStud = s.mbrStud
  WHERE i.ocjena = 1
  GROUP BY s.mbrStud, s.prezStud
  HAVING COUNT(*) > 9;


üîπ BLOK 5 (kraƒáe formulisan)
1Ô∏è‚É£ Izbrisati studente roƒëene prije 1985.

  DELETE FROM stud
  WHERE datRodStud < '1985-01-01';


2Ô∏è‚É£ Svi iz jedne org. jedinice premje≈°teni u drugu 
(generalni oblik).
Npr. sa 'Stara orgjed' na 'Nova orgjed':

  UPDATE nastavnik
  SET sifOrgjed = (
      SELECT sifOrgjed FROM orgjed
      WHERE nazOrgjed = 'Nova orgjed'
  )
  WHERE sifOrgjed = (
      SELECT sifOrgjed FROM orgjed
      WHERE nazOrgjed = 'Stara orgjed'
  );


3Ô∏è‚É£ Napuniti privremenu tabelu sa: sifPred, nazPred, 
broj polo≈æenih ispita, prosjeƒçnom ocjenom.

  CREATE TEMPORARY TABLE predStat AS
  SELECT p.sifPred,
         p.nazPred,
         COUNT(*) AS brPolozenih,
         AVG(i.ocjena) AS prosjek
  FROM pred p
  JOIN ispit i ON i.sifPred = p.sifPred
  WHERE i.ocjena > 1
  GROUP BY p.sifPred, p.nazPred;



4Ô∏è‚É£ Ispisati prezime, ime nastavnika i prosjeƒçnu ocjenu 
svih polo≈æenih ispita
koje je on ocijenio, ali samo ako je prosjek > 3.5.

  SELECT n.prezNastavnik,
         n.imeNastavnik,
         AVG(i.ocjena) AS prosjek
  FROM nastavnik n
  JOIN ispit i ON i.sifNastavnik = n.sifNastavnik
  WHERE i.ocjena > 1
  GROUP BY n.sifNastavnik, n.prezNastavnik, n.imeNastavnik
  HAVING AVG(i.ocjena) > 3.5;




üîπZa svaki B (nadorgjed) ispisati ≈°ifru, naziv i broj 
podreƒëenih orgj. jedinica.

  SELECT B.sifOrgjed,
         B.nazOrgjed,
         COUNT(*) AS brojPodredjenih
  FROM orgjed
  JOIN orgjed B ON orgjed.sifNadorgjed = B.sifOrgjed
  GROUP BY B.sifOrgjed, B.nazOrgjed;



1Ô∏è‚É£ Indeks ispit1 da jedan nastavnik ne mo≈æe dr≈æati 
ispite iz vi≈°e predmeta u istom danu.

  CREATE UNIQUE INDEX ispit1
  ON ispit (sifNastavnik, datIspit);


2Ô∏è‚É£ Relaciju pred1(sifPred, kratPred, nazPred) napuniti 
predmetima iz pred koji pripadaju org. jedinici 
'Zavod za primijenjeno raƒçunarstvo'.

  INSERT INTO pred1 (sifPred, kratPred, nazPred)
  SELECT p.sifPred, p.kratPred, p.nazPred
  FROM pred p
  WHERE p.sifOrgjed = (
      SELECT o.sifOrgjed
      FROM orgjed o
      WHERE o.nazOrgjed = 'Zavod za primijenjeno racunarstvo'
  );


3Ô∏è‚É£ Sve podatke iz stud prekopirati u privremenu tabelu stud1.
Iz stud1 obrisati sve studente roƒëene nakon 1985.

  CREATE TEMPORARY TABLE stud1 AS
  SELECT * FROM stud;

  DELETE FROM stud1
  WHERE YEAR(datRodStud) > 1985;


4Ô∏è‚É£ Svi predmeti sa orgjed 'Zavod za primijenjeno raƒçunartvo'
premje≈°teni su na orgjed 'Zavod za automatiku i robotiku'.
Unijeti to u pred.

  UPDATE pred
  SET sifOrgjed = (
      SELECT sifOrgjed
      FROM orgjed
      WHERE nazOrgjed = 'Zavod za automatiku i robotiku'
  )
  WHERE sifOrgjed = (
      SELECT sifOrgjed
      FROM orgjed
      WHERE nazOrgjed = 'Zavod za primijenjeno racunarstvo'
  );


3Ô∏è‚É£ Ispisati ≈°ifre predmeta koji imaju prosjek pozitivnih ocjena > 3.

SELECT sifPred
FROM ispit
WHERE ocjena > 1
GROUP BY sifPred
HAVING AVG(ocjena) > 3;


1Ô∏è‚É£ Kreirati indeks pred1 nad pred tako da u jednoj org. jedinici
ne mo≈æe postojati vi≈°e predmeta sa istim nazivom i kraticom.

  CREATE UNIQUE INDEX pred1
  ON pred (sifOrgjed, nazPred, kratPred);


2Ô∏è‚É£ Relaciju stud1(mbrStud, prezStud, imeStud) napuniti studentima 
roƒëenim u mjestu 'Karlovac'.

  INSERT INTO stud1 (mbrStud, prezStud, imeStud)
  SELECT s.mbrStud, s.prezStud, s.imeStud
  FROM stud s
  WHERE s.pbrRod = (
      SELECT m.pbr
      FROM mjesto m
      WHERE m.nazMjesto = 'Karlovac'
  );

3Ô∏è‚É£ Kopirati pred u privremenu tabelu pred1, pa iz pred1 obrisati
sve predmete ƒçiji naziv poƒçinje samoglasnikom (A,E,I,O,U).

  CREATE TEMPORARY TABLE pred1 AS
  SELECT * FROM pred;

  DELETE FROM pred1
  WHERE nazPred RLIKE '^[AEIOU]';


4Ô∏è‚É£ Svi nastavnici sa orgjed 'Fakultet elektrotehnike'
premje≈°teni su na 'Fakultet elektrotehnike i raƒçunarstva'.

  UPDATE nastavnik
  SET sifOrgjed = (
      SELECT sifOrgjed
      FROM orgjed
      WHERE nazOrgjed = 'Fakultet elektrotehnike i racunarstva'
  )
  WHERE sifOrgjed = (
      SELECT sifOrgjed
      FROM orgjed
      WHERE nazOrgjed = 'Fakultet elektrotehnike'
  );


1Ô∏è‚É£ Ispisati ime, prezime nastavnika i prosjeƒçan prosjek svih 
polo≈æenih ispita koje je ocijenio, gdje prosjek > 3.5.

  SELECT n.imeNastavnik,
         n.prezNastavnik,
         AVG(i.ocjena) AS prosjek
  FROM nastavnik n
  JOIN ispit i ON i.sifNastavnik = n.sifNastavnik
  WHERE i.ocjena > 1
  GROUP BY n.sifNastavnik, n.imeNastavnik, n.prezNastavnik
  HAVING AVG(i.ocjena) > 3.5;


2Ô∏è‚É£ Svi predmeti sa npr. orgjed 'Zavod za primijenjeno raƒçunarstvo'
premje≈°teni su na 'Zavod za AR'.

UPDATE pred
SET sifOrgjed = (
    SELECT sifOrgjed
    FROM orgjed
    WHERE nazOrgjed = 'Zavod za AR'
)
WHERE sifOrgjed = (
    SELECT sifOrgjed
    FROM orgjed
    WHERE nazOrgjed = 'Zavod za primijenjeno racunarstvo'
);

